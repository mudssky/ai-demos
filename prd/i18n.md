针对 Next.js (App Router) 且要求 **静态导出 (`output: 'export'`)** 的网站，我强烈推荐使用 **`next-intl`**。

它是目前 Next.js 生态中最成熟、对 Server Components 支持最好，且完美支持静态生成的 i18n 解决方案。

以下是针对你的“AI 代码库”项目的具体实施方案：

### 1. 核心技术选型

* **库**: `next-intl`
* **路由策略**: `/[locale]/...` (基于路径的路由，如 `/zh/demo/01` 和 `/en/demo/01`)
* **数据存储**: JSON 文件 (`messages/zh.json`, `messages/en.json`)

---

### 2. 目录结构改造

为了支持多语言，你的 `app` 目录结构需要调整，把所有页面都放入 `[locale]` 文件夹中：

```text
my-ai-gallery/
├── messages/             # 存放翻译文件
│   ├── en.json
│   └── zh.json
├── app/
│   └── [locale]/         # 核心变化：所有页面都在这里
│       ├── layout.tsx
│       ├── page.tsx      # 首页
│       └── demo/
│           └── [slug]/
│               └── page.tsx
├── middleware.ts         # (可选) 用于重定向根路径 / 到 /zh 或 /en
└── next.config.mjs
```

### 3. 具体实施步骤

#### 第一步：安装依赖

```bash
npm install next-intl
```

#### 第二步：配置 `next.config.mjs`

你需要启用 `next-intl` 的插件。

```javascript
import createNextIntlPlugin from 'next-intl/plugin';

const withNextIntl = createNextIntlPlugin();

/** @type {import('next').NextConfig} */
const nextConfig = {
  output: 'export', // 你的静态导出需求
  // 静态导出时通常不使用 Image Optimization API，除非用云服务
  images: { unoptimized: true }, 
};

export default withNextIntl(nextConfig);
```

#### 第三步：创建翻译文件

`messages/en.json`:

```json
{
  "HomePage": {
    "title": "AI Code Gallery",
    "subtitle": "Explore HTML/React code generated by AI agents."
  },
  "DemoPage": {
    "back": "Back to List",
    "prompt": "Prompt",
    "copy": "Copy Code"
  }
}
```

`messages/zh.json`:

```json
{
  "HomePage": {
    "title": "AI 代码画廊",
    "subtitle": "探索由 AI Agent 生成的 HTML/React 代码。"
  },
  "DemoPage": {
    "back": "返回列表",
    "prompt": "提示词",
    "copy": "复制代码"
  }
}
```

#### 第四步：定义 i18n 配置 (`src/i18n/request.ts` 或 `i18n.ts`)

Next.js 需要知道如何加载这些文件。

```typescript
import {notFound} from 'next/navigation';
import {getRequestConfig} from 'next-intl/server';
 
const locales = ['en', 'zh'];
 
export default getRequestConfig(async ({locale}) => {
  if (!locales.includes(locale as any)) notFound();
 
  return {
    messages: (await import(`../../messages/${locale}.json`)).default
  };
});
```

#### 第五步：改造 Layout 和 Page (静态生成的关键)

因为你要做静态网站 (`output: 'export'`)，不能依赖服务器端中间件来动态检测语言，你必须**显式生成所有语言的静态路径**。

**`app/[locale]/layout.tsx`**:

```tsx
import {NextIntlClientProvider} from 'next-intl';
import {getMessages} from 'next-intl/server';
import {notFound} from 'next/navigation';

// 1. 生成静态参数：告诉 Next.js 有哪些语言需要构建
export function generateStaticParams() {
  return [{locale: 'en'}, {locale: 'zh'}];
}

export default async function LocaleLayout({
  children,
  params: {locale}
}: {
  children: React.ReactNode;
  params: {locale: string};
}) {
  // 确保语言有效
  if (!['en', 'zh'].includes(locale)) notFound();

  // 获取对应的翻译消息
  const messages = await getMessages();

  return (
    <html lang={locale}>
      <body>
        <NextIntlClientProvider messages={messages}>
          {children}
        </NextIntlClientProvider>
      </body>
    </html>
  );
}
```

#### 第六步：在组件中使用

**`app/[locale]/page.tsx`**:

```tsx
import {useTranslations} from 'next-intl';
import Link from 'next/link';

export default function HomePage() {
  const t = useTranslations('HomePage');

  return (
    <main>
      <h1>{t('title')}</h1>
      <p>{t('subtitle')}</p>
      {/* 注意：Link 会自动处理当前语言前缀，例如在 /zh 下指向 /zh/demo/... */}
      <Link href="/demo/glassmorphism">查看 Demo</Link>
    </main>
  );
}
```

---

### 4. 重点难点：元数据 (`meta.json`) 的国际化

你的 `_demos/xxx/meta.json` 数据是动态读取的，这部分内容不在 `messages/zh.json` 里。你有两种处理方案：

**方案 A：在 meta.json 中直接包含多语言 (推荐)**

这是最适合静态网站的方案，数据和文件在一起。

```json
// _demos/01-glassmorphism/meta.json
{
  "id": "001",
  "type": "react",
  "title": {
    "en": "Glassmorphism Card",
    "zh": "毛玻璃拟态卡片"
  },
  "description": {
    "en": "A modern card with blur effect.",
    "zh": "一个带有模糊效果的现代风格卡片。"
  },
  "prompt": {
     // Prompt 通常保留原文，因为翻译后 AI 生成的结果就不一样了
     "main": "Create a glassmorphism card..." 
  }
}
```

**代码调整 (`lib/demos.ts`)**:

```typescript
// 修改获取数据的方法，接收 locale 参数
export function getDemoBySlug(slug: string, locale: string) {
  const meta = ...; // 读取 json
  
  return {
    ...meta,
    // 覆盖为当前语言的标题
    title: meta.title[locale] || meta.title['en'],
    description: meta.description[locale] || meta.description['en'],
  };
}
```

### 5. 关于根路径重定向

对于静态导出站点（如部署在 GitHub Pages 或 S3），你无法使用 Next.js 的 Middleware 进行 `user-agent` 语言检测跳转。

通常的做法是：

1. **在根目录 `app/page.tsx` (不在 [locale] 下)** 写一个简单的重定向逻辑。
2. 或者直接放一个着陆页，让用户手动选语言。

**简单的根重定向 (`app/page.tsx`):**

```tsx
import { redirect } from 'next/navigation';

export default function RootPage() {
  // 静态站点无法检测浏览器语言，通常默认重定向到主语言，比如英文
  redirect('/en');
}
```

### 总结

* 使用 **`next-intl`**。
* 将所有页面移动到 **`app/[locale]/`**。
* 在 `layout.tsx` 中使用 **`generateStaticParams`** 预构建所有语言页面。
* 在 **`meta.json`** 中存储多语言标题和描述。
