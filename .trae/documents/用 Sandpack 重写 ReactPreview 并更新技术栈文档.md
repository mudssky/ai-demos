## ğŸ§­ Plan
- [ ] Goalsï¼šå°† `ReactPreview.tsx` ç”±è‡ªå»º iframe+Babel æ–¹æ¡ˆæ”¹ä¸º `@codesandbox/sandpack-react`ï¼Œä¿æŒç°æœ‰ props ä½¿ç”¨ä½“éªŒï¼›åŒæ­¥åœ¨é¡¹ç›®è§„åˆ™ä¸æŠ€æœ¯æ ˆæ–‡æ¡£ä¸­æ–°å¢ Sandpack é›†æˆè¯´æ˜ã€‚
- [ ] Stepsï¼š
  - [ ] Step 1: Context Gatheringï¼ˆåˆ—å‡ºè¦è¯»å–çš„æ–‡ä»¶/ç›®å½•ï¼‰
    - `src/components/ReactPreview.tsx`
    - `package.json`ï¼ˆç¡®è®¤æœªå®‰è£… `@codesandbox/sandpack-react`ï¼‰
    - `prd/docs/technical-stack.md`ã€`.trae/rules/project_rules.md`ï¼ˆäº†è§£æ–‡æ¡£ç»“æ„ä¸æ›´æ–°ä½ç½®ï¼‰
  - [ ] Step 2: Implementationï¼ˆæè¿°åŸå­åŒ–ä¿®æ”¹ï¼‰
    - åœ¨ `package.json` å®‰è£…è¿è¡Œæ—¶ä¾èµ–ï¼š`@codesandbox/sandpack-react`ï¼ˆå¦‚éœ€ä¸»é¢˜å¯é€‰ `@codesandbox/sandpack-themes`ï¼‰ã€‚
    - é‡å†™ `src/components/ReactPreview.tsx`ï¼š
      - ç»§ç»­ä½¿ç”¨ `"use client"`ï¼›ä¿ç•™ `ReactPreviewProps`ï¼ˆ`code`ã€`className`ã€`height`ã€`title`ï¼‰ã€‚
      - ä½¿ç”¨ `SandpackProvider template="react-ts"`ï¼Œé€šè¿‡ `files={{"/App.tsx": code}}` æ³¨å…¥ç”¨æˆ·ä»£ç ã€‚
      - ä½¿ç”¨ `SandpackLayout + SandpackPreview` æ¸²æŸ“é¢„è§ˆï¼›å®¹å™¨æ ·å¼ä¸é«˜åº¦æ²¿ç”¨åŸç»„ä»¶ï¼ˆ`className`ã€`height`ï¼‰ã€‚
      - å–æ¶ˆ CDN `react/react-dom/@babel` ä¸ `iframe srcDoc` ç”Ÿæˆé€»è¾‘ï¼Œç§»é™¤ `sandbox` ä¸ `referrerPolicy`ã€‚
    - ä¿æŒç»„ä»¶ API å°½é‡ç¨³å®šï¼šä¸å¼•å…¥ breaking changesï¼ˆè°ƒç”¨æ–¹åªéœ€ä¼  `code` å³å¯é¢„è§ˆï¼‰ã€‚
  - [ ] Step 3: Verificationï¼ˆåˆ—å‡ºå°†æ‰§è¡Œçš„æ ¡éªŒå‘½ä»¤ï¼‰
    - `pnpm add @codesandbox/sandpack-react`ï¼ˆå¦‚é‡‡ç”¨ä¸»é¢˜ï¼šå†åŠ  `@codesandbox/sandpack-themes`ï¼‰ã€‚
    - `pnpm qa`ï¼ˆå« `typecheck:fast`ã€`biome:fixAll`ã€`vitest run`ï¼‰ã€‚
    - æœ¬åœ°è¿è¡Œ `pnpm dev`ï¼Œåœ¨ç¤ºä¾‹é¡µé¢æ³¨å…¥æµ‹è¯•ä»£ç ç‰‡æ®µï¼ˆå®šä¹‰é»˜è®¤å¯¼å‡º `App` ç»„ä»¶ï¼‰éªŒè¯æ¸²æŸ“ä¸é«˜åº¦æ§åˆ¶ã€‚
  - [ ] Step 4: Documentation Updateï¼ˆè¯´æ˜éœ€è¦æ›´æ–°çš„æ–‡æ¡£ï¼‰
    - æ›´æ–° `.trae/rules/project_rules.md`ï¼š
      - åœ¨æ ¸å¿ƒæŠ€æœ¯æ ˆæˆ–æ¨èæ¨¡å¼ä¸­åŠ å…¥ â€œReact ç»„ä»¶åœ¨çº¿é¢„è§ˆï¼š`@codesandbox/sandpack-react`ï¼ˆå®¢æˆ·ç«¯ç»„ä»¶ï¼‰â€ã€‚
      - è§„èŒƒè¦ç‚¹ï¼šä»…å®¢æˆ·ç«¯ç»„ä»¶ã€`template: react-ts`ã€é€šè¿‡ `files` æ³¨å…¥ã€é¿å… SSRã€æ³¨æ„ä½“ç§¯ä¸é¦–æ¬¡ç¼–è¯‘æ—¶é—´ã€‚
    - æ›´æ–° `prd/docs/technical-stack.md`ï¼š
      - æ–°å¢ â€œSandpack é›†æˆè¯´æ˜â€ å°èŠ‚ï¼šç‰ˆæœ¬å»ºè®®ã€å®‰è£…ã€æœ€å°ä½¿ç”¨ç¤ºä¾‹ï¼ˆ`Provider/Layout/Preview`ï¼‰ã€å¸¸è§é—®é¢˜ï¼ˆSSR/é«˜åº¦/é»˜è®¤å…¥å£æ–‡ä»¶ï¼‰ã€‚

**Impact Analysisï¼ˆå½±å“é¢åˆ†æï¼‰**ï¼š
- Files Modifiedï¼š
  - `src/components/ReactPreview.tsx`
  - `.trae/rules/project_rules.md`
  - `prd/docs/technical-stack.md`
  - `package.json`ï¼ˆæ–°å¢ä¾èµ–ï¼‰
- Potential Risksï¼š
  - é¦–æ¬¡åŠ è½½ä½“ç§¯ä¸æ‰“åŒ…æ—¶é—´å¢åŠ ï¼›å¯é€šè¿‡æ‡’åŠ è½½è¯¥ç»„ä»¶æˆ–åœ¨æ–‡æ¡£ä¸­æç¤ºã€‚
  - ä»…å®¢æˆ·ç«¯å¯ç”¨ï¼ŒæœåŠ¡ç«¯æ¸²æŸ“é¡µé¢ä¸å¯ç›´æ¥å¼•å…¥ï¼›å·²ä¿ç•™ `"use client"`ã€‚
  - ç”¨æˆ·ä¼ å…¥çš„ `code` å¿…é¡»å¯¼å‡ºé»˜è®¤ `App` ç»„ä»¶ï¼›åœ¨æ–‡æ¡£ä¸­æ˜ç¡®è¿™ä¸€è¦æ±‚ã€‚
  - å¦‚éœ€ä¸»é¢˜æˆ–æ›´å¤æ‚äº¤äº’ï¼ˆç¼–è¾‘å™¨ç­‰ï¼‰ï¼Œåç»­å†æŒ‰éœ€æ‰©å±•ã€‚